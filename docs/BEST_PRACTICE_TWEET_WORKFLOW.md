# 最適なツイートワークフロー設計

## 📋 目標

- ✅ **口数少なく、正確な情報を発信**
- ✅ **毎日決まったタイミングで自動実行**
- ✅ **LINEで確認**
- ✅ **記事動向の要約もLINEに送信**
- ✅ **OKが出たら投稿**

---

## 🎯 推奨ワークフロー

### 方法A: スプレッドシート承認フロー（推奨）

**流れ:**
```
1. 定期実行スクリプト（毎日決まったタイミング）
   ↓
2. ツイート文案を自動生成
   ↓
3. 記事動向を要約
   ↓
4. LINE通知でプレビュー送信（ツイート文案 + 記事動向要約）
   ↓
5. スプレッドシートに「下書き」として記録
   ↓
6. ユーザーがLINEで確認
   ↓
7. スプレッドシートで「承認済み」に変更（手動またはコマンド）
   ↓
8. 定期実行スクリプトが「承認済み」を検知
   ↓
9. 自動でツイート投稿
   ↓
10. LINE通知で結果を送信
```

**メリット:**
- ✅ サーバー不要
- ✅ 既存のスプレッドシート実装を活用
- ✅ 承認履歴が記録される
- ✅ 下書きとして保存可能
- ✅ 承認後の自動投稿が可能

**デメリット:**
- ⚠️ リアルタイムではなく、定期実行が必要

---

### 方法B: コマンド実行方式（シンプル）

**流れ:**
```
1. 定期実行スクリプト（毎日決まったタイミング）
   ↓
2. ツイート文案を自動生成
   ↓
3. 記事動向を要約
   ↓
4. LINE通知でプレビュー送信（ツイート文案 + 記事動向要約）
   ↓
5. スプレッドシートに「下書き」として記録
   ↓
6. ユーザーがLINEで確認
   ↓
7. 承認コマンドを実行（手動）
   ↓
8. ツイート投稿
   ↓
9. LINE通知で結果を送信
```

**メリット:**
- ✅ 最もシンプル
- ✅ サーバー不要
- ✅ 承認タイミングをユーザーが完全に制御

**デメリット:**
- ⚠️ 手動操作が必要

---

### 方法C: LINE Webhook承認（将来的に）

**流れ:**
```
1. 定期実行スクリプト（毎日決まったタイミング）
   ↓
2. ツイート文案を自動生成
   ↓
3. 記事動向を要約
   ↓
4. LINE通知でプレビュー送信（ツイート文案 + 記事動向要約）
   ↓
5. ユーザーがLINEで「OK」と返信
   ↓
6. WebhookでOK返信を受け取る
   ↓
7. 自動でツイート投稿
   ↓
8. LINE通知で結果を送信
```

**メリット:**
- ✅ 完全自動化
- ✅ LINE上で完結

**デメリット:**
- ⚠️ Webhook URLが必要（HTTPS必須）
- ⚠️ サーバーが必要（ngrok、Heroku、AWS Lambdaなど）

---

## 💡 推奨アプローチ

### Phase 1: 方法A（スプレッドシート承認フロー）+ 方法B（コマンド実行）のハイブリッド

**理由:**
- ✅ サーバー不要で実装可能
- ✅ 下書きとして保存可能
- ✅ 承認後の自動投稿も可能（定期実行）
- ✅ 手動での承認も可能（コマンド実行）

**実装内容:**
1. 定期実行スクリプト（毎日決まったタイミング）
2. ツイート文案自動生成
3. 記事動向要約
4. LINE通知でプレビュー送信
5. スプレッドシートに「下書き」として記録
6. ユーザーが確認
7. **方法A:** スプレッドシートで「承認済み」に変更 → 定期実行で自動投稿
8. **方法B:** 承認コマンドを実行 → 即座に投稿

---

## 🚀 実装内容

### 1. 定期実行スクリプト（毎日決まったタイミング）

**機能:**
- 毎日決まったタイミングで実行（cron、scheduleライブラリなど）
- ツイート文案を自動生成
- 記事動向を要約
- LINE通知でプレビュー送信
- スプレッドシートに「下書き」として記録

**実行タイミング例:**
- 毎日 9:00（朝の情報配信）
- 毎日 18:00（夕方の情報配信）

### 2. ツイート文案自動生成

**機能:**
- 記事動向を分析
- 要点を抽出
- 280文字以内のツイート文案を生成
- ハッシュタグを自動追加

**生成ルール:**
- 口数少なく（簡潔）
- 正確な情報
- 興味を引く表現

### 3. 記事動向要約

**機能:**
- WordPress RSSフィードから新着記事を取得
- 記事タイトル・要約を抽出
- 簡潔にまとめてLINE通知

### 4. LINE通知（ツイート文案 + 記事動向要約）

**送信内容:**
- ツイート文案
- 記事動向要約
- 承認待ちリストへのリンク（スプレッドシート）

### 5. スプレッドシート管理

**ステータス管理:**
- 「下書き」→ 承認待ち
- 「承認済み」→ 投稿待ち
- 「投稿済み」→ 投稿完了

### 6. 承認後の自動投稿（定期実行）

**機能:**
- 定期実行スクリプトが「承認済み」を検知
- 自動でツイート投稿
- LINE通知で結果を送信
- ステータスを「投稿済み」に更新

---

## 📝 実装ファイル構成

```
automation/
├── social_media/
│   ├── scheduled_tweet.py       # 定期実行スクリプト（毎日決まったタイミング）
│   ├── tweet_generator.py       # ツイート文案自動生成
│   ├── article_summarizer.py    # 記事動向要約
│   ├── approval_manager.py      # 承認待ちリスト管理（既存）
│   └── approve_tweet.py         # 承認済みツイート投稿（既存・拡張）
└── scripts/
    └── daily_tweet_scheduler.py # 毎日の定期実行（cron / schedule）
```

---

## 🎯 ワークフロー例

### 毎日 9:00 の自動実行

```
1. scheduled_tweet.py が実行（9:00）
   ↓
2. ツイート文案を自動生成
   ↓
3. 記事動向を要約（新着記事がある場合）
   ↓
4. LINE通知で送信：
   「📝 本日のツイート案
   
   [ツイート文案]
   
   📰 記事動向：
   - 新着記事: CBDとは？
   - 新着記事: CBDの効果
   
   承認待ちリスト: [スプレッドシートURL]」
   ↓
5. スプレッドシートに「下書き」として記録
   ↓
6. ユーザーがLINEで確認
   ↓
7. スプレッドシートで「承認済み」に変更
   ↓
8. 定期実行スクリプトが「承認済み」を検知（次回実行時）
   ↓
9. 自動でツイート投稿
   ↓
10. LINE通知で結果を送信
```

---

## 🔧 実装方法

### Step 1: 定期実行スクリプトの実装

**方法A: schedule ライブラリ（推奨）**

```python
import schedule
import time

def daily_tweet_job():
    # ツイート文案生成・LINE通知・スプレッドシート記録
    pass

# 毎日 9:00 に実行
schedule.every().day.at("09:00").do(daily_tweet_job)

while True:
    schedule.run_pending()
    time.sleep(60)
```

**方法B: cron（macOS/Linux）**

```bash
# 毎日 9:00 に実行
0 9 * * * /usr/bin/python3 /path/to/scheduled_tweet.py
```

**方法C: GitHub Actions（サーバーレス）**

- 定期実行ワークフローを設定
- 毎日決まったタイミングで実行

### Step 2: ツイート文案自動生成

**機能:**
- 記事動向を分析
- 要点を抽出
- 簡潔なツイート文案を生成

### Step 3: 記事動向要約

**機能:**
- WordPress RSSフィードから新着記事を取得
- 簡潔にまとめてLINE通知

---

## 💡 ベストプラクティス

### 1. ツイート文案生成ルール

- **口数少なく:** 140文字以内を推奨
- **正確な情報:** 記事内容に基づく
- **興味を引く:** 読者の関心を引く表現

### 2. 記事動向要約

- **新着記事のみ:** 過去24時間以内の記事
- **簡潔に:** 各記事を1行で要約
- **URL付き:** 記事URLを含める

### 3. 承認フロー

- **下書きとして保存:** 承認前にスプレッドシートに記録
- **承認後自動投稿:** 定期実行で自動投稿
- **手動投稿も可能:** コマンド実行で即座に投稿

---

## 🚀 次のステップ

1. **定期実行スクリプトの実装**
2. **ツイート文案自動生成機能の実装**
3. **記事動向要約機能の実装**
4. **承認後の自動投稿機能の実装**

---

この方針で進めますか？
