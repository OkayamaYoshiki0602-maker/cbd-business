# 現在の状況と今後の方針

## 📊 プロジェクト概要

**目標:** CBDサイト（https://cbd-no-hito.com/）の自動化とCVR 10%達成

**現状:** 自動ツイートシステムの基盤が完成。改善と最適化の段階

---

## ✅ 実装完了項目

### 1. 基盤システム

#### 1.1 Googleサービス連携
- ✅ **Google Sheets API**: スプレッドシートの読み書き、シート作成
- ✅ **Google Calendar API**: カレンダーへの予定追加
- ✅ **GA4 API**: アクセス数統計の取得
- ⚠️ **Gmail API**: OAuth 2.0が必要（将来実装）

**使用状況:**
- 承認待ちリストのスプレッドシート管理
- GA4データの自動収集（将来の分析用）

#### 1.2 X (Twitter) API連携
- ✅ API認証設定完了
- ✅ ツイート投稿機能
- ✅ ユーザー情報取得

**使用状況:**
- 承認済みツイートの自動投稿

#### 1.3 LINE Messaging API連携
- ✅ チャンネル作成・設定完了
- ✅ ブロードキャストメッセージ送信
- ✅ ツイートプレビュー通知

**使用状況:**
- ツイート案のプレビュー通知
- 投稿結果の通知

---

### 2. 自動ツイートシステム

#### 2.1 WordPress記事からのツイート生成
- ✅ RSSフィードから新着記事を検知
- ✅ 記事本文を取得（BeautifulSoup）
- ✅ Gemini APIで要約・見所を抽出
- ✅ URL短縮機能（Bitly API対応、簡易版実装）
- ✅ ツイートフォーマッター（ハッシュタグ削除、改行・タイトル追加）

**動作フロー:**
```
WordPress RSS → 記事検知 → 本文取得 → AI要約 → フォーマット → スプレッドシート追加 → LINE通知
```

#### 2.2 CBDニュースからのツイート生成
- ✅ RSSフィードから直近1か月のニュースを収集
- ✅ Gemini APIでツイート文案を生成
- ✅ 意外性・効果・研究・社会への影響を考慮
- ✅ 日本の読者が興味を持ちそうな内容を生成
- ✅ ツイートフォーマッター適用

**動作フロー:**
```
RSS収集（1か月分） → ニュース選択 → AI生成 → フォーマット → スプレッドシート追加 → LINE通知
```

#### 2.3 承認ワークフロー
- ✅ スプレッドシートで承認管理（下書き→承認済み→投稿済み）
- ✅ 重複エントリー防止機能
- ✅ 承認済みツイートの自動投稿
- ✅ 投稿結果のLINE通知

**動作フロー:**
```
ツイート案生成 → スプレッドシート（下書き） → ユーザー承認 → 承認済み → 自動投稿 → 投稿済み
```

#### 2.4 定期実行システム
- ✅ macOS Launch Agent設定
- ✅ 毎朝7:00にツイート案生成
- ✅ 毎日12:30に承認済みツイート投稿

**実行スケジュール:**
- 7:00 AM: ツイート案生成（WordPress記事またはニュース）
- 12:30 PM: 承認済みツイート投稿

---

### 3. ツイート品質改善

#### 3.1 フォーマッター実装
- ✅ ハッシュタグ削除（チープな印象を回避）
- ✅ 改行の適切な追加（段落構成）
- ✅ タイトル追加（【】記号を使用）
- ✅ URL保持（280文字以内に調整）

**改善前:**
```
CBDの効果が明らかに！2024年のデータで判明した驚きの事実とは？詳しくはこちら https://example.com #CBD
```

**改善後:**
```
【CBDの効果が明らかに！】
2024年のデータで判明した驚きの事実とは？

https://example.com
```

#### 3.2 Gemini API統合
- ✅ 最新モデル使用（gemini-2.5-flash）
- ✅ 記事要約・見所抽出
- ✅ ニュースからのツイート生成
- ✅ 日本の読者向けに最適化

---

## 📈 現在の機能

### 実装済み機能一覧

| 機能 | 状態 | 説明 |
|------|------|------|
| WordPress記事検知 | ✅ | RSSフィードから新着記事を自動検知 |
| 記事要約・見所抽出 | ✅ | Gemini APIで要約・見所を抽出 |
| ニュース収集 | ✅ | 直近1か月のCBD・大麻関連ニュースを収集 |
| ツイート生成 | ✅ | AI活用でツイート文案を生成 |
| ツイートフォーマット | ✅ | ハッシュタグ削除、改行・タイトル追加 |
| URL短縮 | ✅ | Bitly API対応、簡易版実装 |
| 承認ワークフロー | ✅ | スプレッドシートで承認管理 |
| 重複防止 | ✅ | 同じ記事タイトル・ソースで本日追加されたものはスキップ |
| 自動投稿 | ✅ | 承認済みツイートを自動投稿 |
| LINE通知 | ✅ | プレビュー・投稿結果を通知 |
| 定期実行 | ✅ | Launch Agentで毎日実行 |

---

## 🚧 実装中・改善中

### 1. バズツイート分析機能（部分実装）
- ✅ バズアカウント分析スクリプト（`buzz_analyzer.py`）
- ✅ バズパターン分析スクリプト（`buzz_pattern_analyzer.py`）
- ⚠️ 毎日のツイート生成への自動統合（未完了）

**現状:**
- 分析スクリプトは実装済み
- 週次分析機能は実装済み（`weekly_buzz_analyzer.py`）
- 分析結果を毎日のツイート生成に自動反映する機能が未実装

---

## 🎯 今後の改善項目

### 優先度: 高

#### 1. バズツイート分析の自動統合
**目標:** 他ジャンルの専門アカウントのバズパターンを毎日のツイート生成に反映

**必要な作業:**
1. 分析対象アカウントの選定（フォロワー1万人前後の専門アカウント10件）
2. 週次分析の自動実行設定
3. 分析結果をツイート生成プロンプトに組み込む
4. バズパターンに基づくツイート生成ロジックの改善

**期待効果:**
- バズる可能性が高いツイート構成の自動適用
- エンゲージメント率の向上

---

#### 2. ツイートフォーマットの改善
**目標:** 改行・タイトル・濁点を活用したより魅力的なツイート

**現状:**
- ✅ ハッシュタグ削除: 実装済み
- ✅ 改行追加: 実装済み（改善の余地あり）
- ✅ タイトル追加: 実装済み（【】記号を使用）
- ⚠️ 濁点の活用: 未実装（自然さを優先してコメントアウト）

**必要な作業:**
1. 改行ロジックの改善（段落構成をより意識）
2. タイトル記号のバリエーション追加（■、▶など）
3. 濁点を活用した強調方法の研究・実装

**期待効果:**
- ツイートの視認性向上
- 読者の興味を引く表現

---

#### 3. バズアカウント分析の週次実行
**目標:** 週に1回、バズアカウントを分析して最新のパターンを取得

**必要な作業:**
1. 分析対象アカウントリストの作成（`weekly_buzz_analyzer.py`の`BUZZ_ACCOUNTS`）
2. 週次分析の自動実行設定（Launch Agentまたはcron）
3. 分析結果の保存（スプレッドシートまたはJSONファイル）
4. 分析結果をツイート生成に反映

**期待効果:**
- 最新のバズパターンを継続的に取り入れ
- ツイート戦略の自動最適化

---

### 優先度: 中

#### 4. ツイートパフォーマンス分析
**目標:** 投稿したツイートのエンゲージメントを分析して改善

**必要な作業:**
1. X APIでツイートのエンゲージメントデータを取得
2. スプレッドシートにエンゲージメントデータを記録
3. エンゲージメント率の高いツイートパターンを分析
4. 分析結果をツイート生成に反映

**期待効果:**
- データドリブンなツイート改善
- エンゲージメント率の継続的な向上

---

#### 5. 記事動向要約の改善
**目標:** LINE通知の記事動向要約をより有用な情報に

**現状:**
- ✅ 記事動向要約機能は実装済み
- ⚠️ 要約内容が単純（タイトルとURLのみ）

**必要な作業:**
1. 記事動向要約をAIで要約（Gemini API）
2. 重要なポイントを抽出
3. ユーザーが興味を持ちそうな情報を優先

---

#### 6. URL短縮機能の改善
**目標:** Bitly APIの完全統合（オプション）

**現状:**
- ✅ 簡易的なURL短縮は実装済み
- ⚠️ Bitly APIは実装済みだが、トークン未設定

**必要な作業:**
1. Bitly APIトークンの取得・設定（オプション）
2. URL短縮のテスト

**注意:** Twitter (X)ではURLは常に23文字としてカウントされるため、短縮URLの効果は表示上の改善のみ

---

### 優先度: 低

#### 7. Gmail API連携
**目標:** メール確認機能（将来実装）

**現状:**
- ⚠️ OAuth 2.0が必要（個人Gmailアカウントへのアクセス）
- 実装の優先度は低い

---

## 📋 今すぐできること

### 1. バズアカウント分析の開始
**所要時間:** 30分

**手順:**
1. 分析したいアカウントを10件選定（フォロワー1万人前後の専門アカウント）
2. `automation/social_media/weekly_buzz_analyzer.py`の`BUZZ_ACCOUNTS`に追加
3. 分析を実行: `python3 automation/social_media/weekly_buzz_analyzer.py`
4. 分析結果を確認

---

### 2. 週次分析の自動実行設定
**所要時間:** 15分

**手順:**
1. Launch Agentで週次分析を設定（毎週月曜日の特定時刻など）
2. または、手動実行を週に1回行う

---

### 3. 分析結果をツイート生成に反映
**所要時間:** 1-2時間

**手順:**
1. 分析結果をツイート生成プロンプトに組み込む
2. バズパターンに基づくツイート生成ロジックを改善
3. テスト実行して効果を確認

---

## 🎨 改善の方向性

### 短期（1-2週間）
1. ✅ ハッシュタグ削除、フォーマット改善（完了）
2. 🔄 バズアカウント分析の自動統合
3. 🔄 ツイートフォーマットの改善（改行・タイトル・濁点）

### 中期（1-2か月）
1. ツイートパフォーマンス分析
2. 記事動向要約の改善
3. バズパターンの継続的な最適化

### 長期（3か月以上）
1. データドリブンなツイート戦略の確立
2. エンゲージメント率の継続的な向上
3. CVR 10%達成に向けた施策

---

## 📊 現在のシステム構成図

```
┌─────────────────────────────────────────────────────────────┐
│                    自動ツイートシステム                        │
└─────────────────────────────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        │                   │                   │
   ┌────▼────┐        ┌────▼────┐        ┌────▼────┐
   │ WordPress │        │  CBDニュース │        │ 承認ワークフロー │
   │ 記事検知  │        │  収集・生成  │        │  スプレッドシート │
   └────┬────┘        └────┬────┘        └────┬────┘
        │                   │                   │
        └───────────────────┼───────────────────┘
                            │
                    ┌───────▼────────┐
                    │ ツイート生成・フォーマット │
                    │  (Gemini API)   │
                    └───────┬────────┘
                            │
        ┌───────────────────┼───────────────────┐
        │                   │                   │
   ┌────▼────┐        ┌────▼────┐        ┌────▼────┐
   │ LINE通知 │        │ 承認待ち │        │ 自動投稿 │
   │ (プレビュー)│        │ スプレッドシート │        │ (X API)  │
   └─────────┘        └─────────┘        └─────────┘
```

---

## 🔄 ワークフロー（現在）

### 毎朝7:00 AM
1. WordPress RSSをチェック
2. 新着記事があれば要約・見所を抽出
3. 新着記事がなければ、CBDニュースを収集・生成
4. ツイートフォーマッターを適用
5. スプレッドシートに「下書き」として追加
6. LINE通知でプレビュー送信

### 毎日12:30 PM
1. スプレッドシートから「承認済み」のツイートを取得
2. X (Twitter)に投稿
3. ステータスを「投稿済み」に更新
4. LINE通知で投稿結果を送信

---

## 📝 次のアクションアイテム

### 今すぐやること（優先度: 高）

1. **バズアカウント分析の開始**
   - [ ] 分析対象アカウントを10件選定
   - [ ] `weekly_buzz_analyzer.py`の`BUZZ_ACCOUNTS`に追加
   - [ ] 分析を実行して結果を確認

2. **分析結果をツイート生成に反映**
   - [ ] 分析結果をツイート生成プロンプトに組み込む
   - [ ] バズパターンに基づくロジックを改善
   - [ ] テスト実行して効果を確認

3. **ツイートフォーマットの改善**
   - [ ] 改行ロジックの改善（段落構成をより意識）
   - [ ] タイトル記号のバリエーション追加
   - [ ] 濁点を活用した強調方法の研究

---

### 今週中にやること（優先度: 中）

4. **週次分析の自動実行設定**
   - [ ] Launch Agentで週次分析を設定
   - [ ] 分析結果の保存方法を決定

5. **ツイートパフォーマンス分析の準備**
   - [ ] X APIでエンゲージメントデータ取得の実装
   - [ ] スプレッドシートへの記録機能

---

## 💡 まとめ

### 現在の強み
- ✅ 自動ツイートシステムの基盤が完成
- ✅ AI活用で高品質なツイートを生成
- ✅ 承認ワークフローが確立
- ✅ ツイートフォーマットが改善（ハッシュタグ削除、改行・タイトル追加）

### 次のステップ
1. **バズアカウント分析の自動統合**（最優先）
2. **ツイートフォーマットの改善**（改行・タイトル・濁点）
3. **ツイートパフォーマンス分析**（データドリブンな改善）

### 長期的な目標
- エンゲージメント率の継続的な向上
- CVR 10%達成
- データドリブンなツイート戦略の確立

---

**最終更新:** 2026-01-11
