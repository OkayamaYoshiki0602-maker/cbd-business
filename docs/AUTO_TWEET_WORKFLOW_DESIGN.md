# 自動ツイートワークフロー設計

## 📋 希望する流れ

```
1. Cursorでニュース作成 or 記事作成
   ↓
2. 作成したタイミングでLINE通知
   ↓
3. ユーザーがLINEで確認してOKする
   ↓
4. OKしたらツイート投稿
```

---

## 🎯 実現方法の比較

### 方法A: LINE Webhook + 承認フロー（推奨）

**流れ:**
1. 記事作成を検知（GitHub、WordPress、手動実行）
2. LINE通知でプレビュー送信
3. ユーザーがLINEで「OK」と返信
4. WebhookでOK返信を受け取る
5. 自動でツイート投稿

**メリット:**
- ✅ 完全自動化
- ✅ LINE上で完結
- ✅ スマートフォンから操作可能

**デメリット:**
- ⚠️ Webhook URL が必要（HTTPS必須）
- ⚠️ サーバーが必要（ngrok、Heroku、AWS Lambdaなど）

**実装難易度:** 中程度

---

### 方法B: スプレッドシート承認フロー（実装簡単）

**流れ:**
1. 記事作成を検知
2. LINE通知でプレビュー送信
3. スプレッドシートに「承認待ち」として記録
4. ユーザーがスプレッドシートで「承認」を入力
5. 定期実行スクリプトで承認を確認
6. 承認されたらツイート投稿

**メリット:**
- ✅ サーバー不要
- ✅ 既存のGoogle Sheets実装を活用
- ✅ 承認履歴が記録される

**デメリット:**
- ⚠️ リアルタイムではなく、定期実行が必要

**実装難易度:** 低

---

### 方法C: コマンド実行方式（最も簡単）

**流れ:**
1. 記事作成を検知
2. LINE通知でプレビュー送信
3. ユーザーが確認後、手動でコマンド実行
4. コマンド実行でツイート投稿

**メリット:**
- ✅ 最も簡単
- ✅ サーバー不要
- ✅ すぐに実装可能

**デメリット:**
- ⚠️ 手動操作が必要
- ⚠️ スマートフォンから実行できない

**実装難易度:** 低

---

### 方法D: Googleカレンダー承認フロー（折衷案）

**流れ:**
1. 記事作成を検知
2. LINE通知でプレビュー送信
3. Googleカレンダーに「承認待ち」イベントを作成
4. ユーザーがイベントを「承認済み」に変更
5. 定期実行スクリプトで承認を確認
6. 承認されたらツイート投稿

**メリット:**
- ✅ サーバー不要
- ✅ 既存のGoogleカレンダー実装を活用
- ✅ スケジュール管理と統合

**デメリット:**
- ⚠️ リアルタイムではない

**実装難易度:** 低〜中

---

## 💡 推奨アプローチ

### Phase 1: 方法C（コマンド実行方式）から開始（即座に実装可能）

**理由:**
- ✅ 最も簡単で、すぐに実装可能
- ✅ サーバー不要
- ✅ 動作確認が容易

**実装内容:**
1. 記事作成検知スクリプト
2. LINE通知でプレビュー送信
3. 承認待ちリストに保存（スプレッドシート）
4. 承認コマンド実行でツイート投稿

### Phase 2: 方法B（スプレッドシート承認フロー）に拡張

**理由:**
- ✅ サーバー不要
- ✅ 承認履歴が記録される
- ✅ 既存のGoogle Sheets実装を活用

### Phase 3: 方法A（LINE Webhook）に完全自動化（将来的に）

**理由:**
- ✅ 完全自動化
- ✅ LINE上で完結

---

## 🚀 Phase 1 実装計画

### 実装内容

1. **記事作成検知スクリプト**
   - WordPress RSS フィード監視
   - または、手動実行で記事情報を指定

2. **LINE通知でプレビュー送信**
   - 既存実装を活用
   - ツイート文案を生成してLINE通知

3. **承認待ちリスト管理（スプレッドシート）**
   - スプレッドシートに承認待ちリストを作成
   - 記事情報・ツイート文案・承認ステータスを記録

4. **承認コマンド実行**
   - スプレッドシートから承認待ちリストを読み込み
   - 承認されたものをツイート投稿

---

## 📝 実装フロー（Phase 1）

```
1. 記事作成 or 手動実行
   ↓
2. automation/social_media/article_detector.py を実行
   ↓
3. ツイート文案を生成
   ↓
4. LINE通知でプレビュー送信
   ↓
5. スプレッドシートに承認待ちとして記録
   ↓
6. ユーザーが確認
   ↓
7. 承認コマンド実行（automation/social_media/approve_tweet.py）
   ↓
8. ツイート投稿
   ↓
9. LINE通知で結果を送信
```

---

## 🛠️ 実装ファイル構成

```
automation/
├── social_media/
│   ├── article_detector.py       # 記事作成検知・ツイート文案生成
│   ├── approval_manager.py       # 承認待ちリスト管理（スプレッドシート）
│   └── approve_tweet.py          # 承認されたツイートを投稿
```

---

## 📊 実装ステップ

### Step 1: 記事作成検知スクリプト作成

- WordPress RSS フィード監視
- 新着記事を検知
- ツイート文案を自動生成

### Step 2: 承認待ちリスト管理

- スプレッドシートに承認待ちリストを作成
- 記事情報・ツイート文案・承認ステータスを記録

### Step 3: 承認コマンド実装

- スプレッドシートから承認待ちリストを読み込み
- 承認されたものをツイート投稿

---

## 💡 次のステップ

1. **Phase 1（コマンド実行方式）を実装**（即座に実装可能）
2. **Phase 2（スプレッドシート承認フロー）に拡張**（サーバー不要）
3. **Phase 3（LINE Webhook）に完全自動化**（将来的に）

---

この方針で進めますか？それとも、別の方法を希望しますか？
