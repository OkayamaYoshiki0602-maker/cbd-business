# Googleサービス権限設定手順

## 📋 概要

既存のサービスアカウント（`cursor-mcp@acoustic-skein-329303.iam.gserviceaccount.com`）に、各Googleサービスへのアクセス権限を付与します。

---

## 🔑 サービスアカウント情報

- **サービスアカウント名:** `cursor-mcp`
- **サービスアカウントID:** `cursor-mcp@acoustic-skein-329303.iam.gserviceaccount.com`
- **認証情報ファイル:** `~/.config/cursor/google-drive-credentials.json`

---

## 🚀 各サービスの権限設定

### PART 1: Googleカレンダー

#### 手順

1. **Googleカレンダーにアクセス**
   - https://calendar.google.com にアクセス
   - `okayamayoshiki0602o@gmail.com` でログイン

2. **左側の「マイカレンダー」からカレンダーを選択**
   - 使用したいカレンダーをクリック（例: 「マイカレンダー」）

3. **「設定と共有」をクリック**
   - カレンダーの右側に「設定と共有」ボタンがある

4. **「特定のユーザーと共有」セクションに移動**
   - 画面を下にスクロール

5. **「ユーザーを追加」をクリック**

6. **サービスアカウントのメールアドレスを入力**
   - `cursor-mcp@acoustic-skein-329303.iam.gserviceaccount.com`

7. **権限を選択**
   - 「変更可能なイベントを表示」を選択（推奨）
   - または「変更と共有の権限を管理」を選択

8. **「送信」をクリック**

#### 確認方法

- 共有されたユーザー一覧にサービスアカウントが表示されることを確認

---

### PART 2: Gmail

#### 注意事項

⚠️ **Gmail APIはサービスアカウントでは直接使用できない場合があります。**

サービスアカウントでGmailにアクセスするには、**Domain-wide delegation（組織全体の委任）**が必要です。個人のGoogleアカウントでは使用できない可能性があります。

#### 代替案（OAuth 2.0認証）

個人アカウントでGmail APIを使用する場合は、OAuth 2.0認証が必要です：

1. **Google Cloud ConsoleでOAuth 2.0 クライアントIDを作成**
2. **認証フローを実行してトークンを取得**
3. **MCPサーバーでトークンを使用**

詳細は後日実装する可能性があります。

---

### PART 3: Googleスプレッドシート

#### 手順

既にGoogle Drive MCPで対応可能ですが、明示的に共有設定を確認します。

1. **Googleスプレッドシートを開く**
   - https://docs.google.com/spreadsheets にアクセス
   - 使用したいスプレッドシートを開く

2. **右上の「共有」ボタンをクリック**

3. **サービスアカウントのメールアドレスを追加**
   - `cursor-mcp@acoustic-skein-329303.iam.gserviceaccount.com`

4. **権限を選択**
   - 「閲覧者」または「編集者」を選択

5. **「送信」をクリック**

#### 確認方法

- 共有されたユーザー一覧にサービスアカウントが表示されることを確認

---

### PART 4: GA4 (Google Analytics 4)

#### 手順

1. **GA4の管理画面にアクセス**
   - https://analytics.google.com にアクセス
   - `okayamayoshiki0602o@gmail.com` でログイン

2. **「管理」（左下の歯車アイコン）をクリック**

3. **「プロパティアクセス管理」をクリック**
   - プロパティ列（真ん中の列）の「アクセス管理」をクリック

4. **「＋」ボタンをクリック**
   - 「ユーザーを追加」を選択

5. **サービスアカウントのメールアドレスを入力**
   - `cursor-mcp@acoustic-skein-329303.iam.gserviceaccount.com`

6. **役割を選択**
   - 「表示者」を選択（データ読み取りのみ）
   - または「編集者」を選択（データ読み取り・設定変更）

7. **「追加」をクリック**

#### 確認方法

- プロパティアクセス管理のユーザー一覧にサービスアカウントが表示されることを確認

#### GA4プロパティ情報

- **プロパティ名:** `CBD WORLD`
- **プロパティID:** `505457597`
- **ウェブサイト:** https://cbd-no-hito.com/

---

## 📝 チェックリスト

### Googleカレンダー
- [ ] カレンダーを選択
- [ ] 「設定と共有」をクリック
- [ ] サービスアカウントのメールアドレスを追加
- [ ] 権限を選択
- [ ] 共有設定を確認

### Gmail
- [ ] OAuth 2.0認証が必要か確認（個人アカウントの場合）
- [ ] 必要に応じてOAuth 2.0 クライアントIDを作成

### Googleスプレッドシート
- [ ] スプレッドシートを開く
- [ ] 「共有」ボタンをクリック
- [ ] サービスアカウントのメールアドレスを追加
- [ ] 権限を選択
- [ ] 共有設定を確認

### GA4
- [ ] GA4の管理画面にアクセス
- [ ] 「プロパティアクセス管理」をクリック
- [ ] サービスアカウントのメールアドレスを追加
- [ ] 役割を選択
- [ ] アクセス管理を確認

---

## 🚀 次のステップ

権限設定後：
1. ✅ Cursorを再起動
2. ✅ MCP連携の動作確認
3. ✅ 各サービスが動作するか確認

詳細は [`GOOGLE_SERVICES_MCP_SETUP.md`](GOOGLE_SERVICES_MCP_SETUP.md) を参照してください。
