# SiteGuardプラグイン REST API設定ガイド

## 🎯 目的

SiteGuardプラグインがREST APIへのアクセスをブロックしている場合の設定方法です。

---

## 📋 確認事項

### Step 1: SiteGuardプラグインが有効か確認

1. WordPress管理画面にログイン
2. 左メニューから **「プラグイン」** を選択
3. **「SiteGuard」** が有効化されているか確認

---

## 🔧 設定方法

### 方法1: SiteGuard管理画面から設定（推奨）

#### Step 1: SiteGuardの設定を開く

1. WordPress管理画面の左メニューから **「SiteGuard」** をクリック
2. または、**「設定」** → **「SiteGuard」** をクリック

#### Step 2: REST APIの設定を確認

SiteGuardの設定画面で、以下のような項目を探してください：

- **「REST API」**
- **「REST API アクセス」**
- **「API アクセス」**
- **「外部アクセス」**

#### Step 3: REST APIを許可する設定を有効化

1. REST API関連の設定項目を探す
2. 以下のような設定を**有効化**：
   - 「REST API を有効にする」
   - 「REST API へのアクセスを許可する」
   - 「外部からのREST APIアクセスを許可する」
   - 「認証済みREST APIアクセスを許可する」
3. 設定を保存

---

### 方法2: 設定ファイルから直接編集（上級者向け）

**注意:** この方法は、データベースや設定ファイルを直接編集するため、慎重に行ってください。事前にバックアップを取ってください。

SiteGuardの設定は通常、データベースの`wp_options`テーブルに保存されています。

---

## 🔍 SiteGuardの設定項目（一般的な例）

SiteGuardプラグインによって、設定項目の名称や場所が異なる場合があります。以下は一般的な設定項目の例です：

### セキュリティ設定

- **「REST API の無効化」** → **無効にする**（オフ）
- **「REST API へのアクセス制限」** → **許可する**
- **「認証済みREST APIアクセス」** → **許可する**

### IPアドレス制限

- **「REST APIへのIPアドレス制限」** → **無効にする** または **「すべて許可」**
- **「ホワイトリスト」** → GitHub ActionsのIP範囲を追加（推奨しない、IPは動的）

### User-Agent制限

- **「User-Agent制限」** → **無効にする** または **「すべて許可」**

---

## ✅ 確認方法

### Step 1: ブラウザでREST APIにアクセス

ブラウザで以下にアクセス：
- https://cbd-no-hito.com/wp-json/wp/v2/posts

**期待される結果:**
- ✅ JSONが表示される

### Step 2: GitHub Actionsを再実行

1. GitHubリポジトリ → **Actions**タブ
2. **「Sync to WordPress」**ワークフローを選択
3. **「Run workflow」**ボタンをクリック
4. エラーが解消されたか確認

---

## 🆘 設定が見つからない場合

### 代替方法1: SiteGuardを一時的に無効化（テスト用）

**注意:** 本番環境では慎重に実施してください。テスト後すぐに有効化してください。

1. WordPress管理画面 → **プラグイン**
2. **「SiteGuard」**プラグインを一時的に無効化
3. GitHub Actionsを再実行
4. エラーが解消された場合、SiteGuardが原因と確定
5. SiteGuardを再度有効化し、設定を調整

---

### 代替方法2: SiteGuardのサポートに問い合わせ

SiteGuardプラグインの設定が複雑な場合、以下の情報を提供してサポートに問い合わせることをお勧めします：

1. **WordPressのバージョン**
2. **SiteGuardプラグインのバージョン**
3. **問題の詳細**（GitHub ActionsからREST APIにアクセスできない）
4. **エラーメッセージ**（403 Forbidden）
5. **ブラウザからのアクセスは成功する**（REST API自体は有効）

---

## 📝 参考情報

- [SiteGuardプラグイン公式サイト](https://siteguard.jp/)
- [SiteGuardプラグインサポート](https://siteguard.jp/support/)

---

## ⚠️ 注意事項

- セキュリティプラグインの設定変更は慎重に行ってください
- 本番環境でのテストは、バックアップを取ってから実施してください
- 一時的な無効化は、テスト後すぐに元に戻してください
- REST APIを完全に開放することはセキュリティリスクがあります。認証（アプリケーションパスワード）を使用することを強く推奨します
